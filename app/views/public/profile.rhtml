<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>

		<% user=@user %>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title>Untitled Document</title>
		
		<style type="text/css"> 
		div.btn{
			float:left;
			color: #000000;
			margin:0px;
			padding:5px;
			text-align:center;
			background: #8DBDE5;
			border:solid 1px #c3c3c3;
		}
		div.form{
			margin:10px;
		}

		</style>
	</head>
	<body>
		
		<div>
			Ticket
			<% @myvar.each do |v| %>
			<table width=800 align=center border=1 bordercolor="green">
				<tr>
					      <td>
					      	<%= v.id.to_s %>
					      </td>	
					      <% sqlQ= "SELECT * FROM seances Where seances.id = ("+ v.seance_id.to_s+") " %>  
						  <% @seances =  Seance.find_by_sql(sqlQ) %>
							<!-- numer seansu  -->
					      <td>
					      	Seans: <%=  var1 = @seances.first.id.to_s %>
					      </td>
							<!-- nazwa kina	-->
					      <td> 	
					      	<% var2 = CinemaFilm.find(var1).cinema_id.to_s %>
					      	Kino: <%= Cinema.find(var2).name.to_s %>
					      </td>	
							<!-- 	nazwa filmu	 -->
					      <td> 	
					      	<% var2 = CinemaFilm.find(var1).film_id.to_s %>
					      	Film: <%= Film.find(var2).title.to_s %>
					      </td>
					      	<!-- 	data i time seansu	 -->
					      <td> 	
					      	<td><%= @seances.first.date_from.to_s %></td>
					      	<td><%= @seances.first.time_from.to_s %></td>
					      </td>
					      
					      <% sqlQ= "SELECT * FROM seats Where seats.id = ("+ v.seat_id.to_s+") " %>  
						  <% @seats =  Seat.find_by_sql(sqlQ) %>
					      	<!-- 	numer pokoju, rząd i kolumna siedzenia	 -->
					      <td>
					      	<% var1 = @seats.first.room_id.to_s %>
					      	<td>Pokój: <%= var2 = Room.find(var1).number.to_s %></td>
					      	<td>Rząd: <%= @seats.first.row.to_s %></td>
					      	<td>Kolumna: <%= @seats.first.column.to_s %></td>
					      </td>
							<!-- 	imie i nazwisko klienta				       -->
					      <% sqlQ= "SELECT * FROM users Where users.id = ("+ v.user_id.to_s+") " %>  
						  <% @users =  User.find_by_sql(sqlQ) %>
					      <td>
					      	imie
					      	nazwisko
					      </td>
							<!-- numer rezerwacji					       -->
					      <td>
					      	Rezerwacja: <%= v.reservation_id.to_s %>
					      </td>
					      <td>
					      	
					      </td>
							<!-- 	numer widoczny tylko w kodzie kreskowym				       -->
					      <td>
					      	<%= v.worker_id.to_s %>
					      </td>
					</tr>	
			</table>
			<% end %>    			
			
		</div>	
		
		
		<div style="float:left;">
			<p>Witaj, <%= user.login %>!</p>
		</div>
		
		<br/><br/>
		
		<div class="btn" onclick="$j('.form').slideToggle('slow');">
			edytuj swoje dane
		</div><br /><br />
		<div class="btn" onclick="$j('.pwd').slideToggle('slow');">
			zmień hasło
		</div>
		
		<div class="form" style="float:right;" hidden="true">
			<%= form_for(@user) do |u| %>
			  <% if @user.errors.any? %>
			    <div id="error_explanation">
			      <h2>Zaszły następujące nieprawidłowości:</h2>
			      <ul>
			      <% @user.errors.full_messages.each do |msg| %>
			        <li><%= msg %></li>
			      <% end %>
			      </ul>
			    </div>
			  <% end %>
			
			  <div class="field">
			    <span style="float: left"><%= u.label :login %></span><br />
			    <%= u.text_field :login, :class => 'validate[required,maxSize[100]]', :size=>45 %>
			  </div>
			  
			  <div class="field">
			  	<span style="float: left"><%= u.label 'Imię' %></span><br />
			    <%= u.text_field :first_name, :class => 'validate[required,maxSize[20]]', :size=>45 %>			 
			  </div>
			  
			  <div>
			  	<span style="float: left"><%= u.label 'Nazwisko' %></span><br />
			    <%= u.text_field :last_name, :class => 'validate[required,maxSize[100]]', :size=>45 %>
			  </div>	
			  		  
			  <div class="field">
			    <span style="float: left"><%= u.label :email%></span><br />
			    <%= u.text_field :email, :class => 'validate[required,maxSize[50]]', :size=>45 %>
			  </div>
	
			  <div class="field">
			    <span style="float: left"><%= u.label :"telefon" %></span><br />
			    <%= u.text_field :phone, :size=>45 %>
			  </div>
			  			  
			  <div class="actions">
			    <%= u.submit "Zapisz"%>
			  </div>
			<% end %>
		</div>

		<div class="pwd" style="float:right;" hidden=true>
			<%= form_for(@user) do |us| %>
			  <% if @user.errors.any? %>
			    <div id="error_explanation">
			      <h2>Zaszły następujące nieprawidłowości:</h2>
			      <ul>
			      <% @user.errors.full_messages.each do |msg| %>
			        <li><%= msg %></li>
			      <% end %>
			      </ul>
			    </div>
			  <% end %>		  
			  
			  <div class="field">
			    <span style="float: left"><%= us.label :"hasło" %></span><br />
			    <%= us.password_field :hashed_password, :size=>45, :value=> "" %>
			  </div>
			  
			  <div class="field">
			    <span style="float: left"><%= us.label :"potwierdź hasło" %></span><br />
			    <%= us.password_field :hashed_password_confirmation, :size=>45 %>
			  </div>	  
				  	
			  <div class="actions">
			    <%= us.submit "Zapisz"%>
			  </div>
			<% end %>
		</div>			
		
		<% link_to 'edytuj', :controller => "users", :action => "edit", :id => user.id.to_s %>
	</body>
</html>
